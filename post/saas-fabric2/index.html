<!doctype html><html lang=zh><head><title>TaibiaoGuo.com</title><meta charset=utf-8><meta content="utf-8" http-equiv=encoding><meta name=viewport content="width=device-width,initial-scale=1"><meta name=format-detection content="telephone=no"><meta name=theme-color content="#000084"><link rel=icon href=https://www.taibiaoguo.com/favicon.ico><link rel=canonical href=https://www.taibiaoguo.com><link href="https://fonts.googleapis.com/css2?family=Noto+Sans+SC&display=swap" rel=stylesheet></head><body><nav class="navbar navbar-inverse navbar-fixed-top"><div class=navbar-inner><div class=container><button type=button class="btn btn-navbar" data-toggle=collapse data-target=.nav-collapse></button>
<a class=brand href=https://www.taibiaoguo.com>TaibiaoGuo.com</a><div class="nav-collapse collapse"><ul class=nav><li><a href=/post/><span>所有博客</span></a></li><li><a href=/about/><span>关于我</span></a></li></ul></div></div></div></nav><div id=content class=container><div class="row-fluid navmargin"><div class=page-header><h1>生产级 BAAS 方案设计和实现 - Thu, May 13, 2021</h1></div><p class=lead>HyperLeger Fabric 2.2 LTS</p><p>目前大部虽然众多云服务厂商已经对外提供了SaaS级别的HyperLedger Fabric服务，但要在私有云环境中构建自己的生产级别HyperLedger Fabric服务依然是非常复杂的事情。
分教程都源自于 HyperLedger Fabric 文档中提供的测试网络（test-network）或已经在 <code>v2.2</code>中删除了的"构建您的第一个网络"(BYFN) 或者
<a href=https://github.com/hyperledger-labs/minifabric>minifabric</a> 这类快速 HyperLedger Fabric 环境搭建工具。
进行的超级账本部署, 或是 HyperLedger Fabric 1.4 TLS 的Kubernetes部署方案 [2] 。</p><h2 id=预备知识>预备知识</h2><p><a href=https://www.hyperledger.org/blog/2020/07/20/new-release-hyperledger-fabric-2-2-lts>Hyperledger Fabric 2.2 LTS</a> (后续简称 Fabric) 是超级账本的最新长期支持版本</p><p>本文主要使用的工具为 Hyperledger Fabric 2.2 LTS 、 Kubernetes 、 Helm3 。</p><h3 id=fabric-相关概念>Fabric 相关概念</h3><ul><li><a href=https://hyperledger-fabric.readthedocs.io/zh_CN/release-2.2/identity/identity.html>Fabric 身份</a> -</li><li><a href=https://hyperledger-fabric.readthedocs.io/zh_CN/release-2.2/membership/membership.html>Fabric 成员服务提供者</a> -</li><li><a href=https://hyperledger-fabric-ca.readthedocs.io/en/latest/users-guide.html>Fabric 证书颁发机构</a> -</li><li><a href=https://hyperledger-fabric.readthedocs.io/zh_CN/release-2.2/membership/membership.html>Fabric 账本</a> -</li><li><a href=https://hyperledger-fabric.readthedocs.io/zh_CN/release-2.2/smartcontract/smartcontract.html>Fabric 链码</a> -</li><li><a href=https://hyperledger-fabric.readthedocs.io/zh_CN/release-2.2/peers/peers.html>Fabric 节点</a> -</li></ul><h3 id=kubernetes-相关概念>Kubernetes 相关概念</h3><ul><li><a href=https://kubernetes.io/docs/concepts/workloads/pods/pod/>Kubernetes Pod</a> - Pod 表示 Kubernetes 集群中可部署的最小单元，用于对必须被视为单个单元的容器进行分组。</li><li><a href=https://kubernetes.io/docs/concepts/workloads/controllers/jobs-run-to-completion/>Kubernetes 作业</a> - 一个作业可创建一个或多个 Pod，并确保成功终止指定数量的 Pod。Pod 成功完成之后，该作业会跟踪成功完成情况。</li><li><a href=https://kubernetes.io/docs/concepts/workloads/controllers/deployment/>Kubernetes 部署</a> - 部署是一种 Kubernetes 资源，您可以在此指定运行应用所需的容器和其他 Kubernetes 资源，比如持久存储、服务或注释。</li><li><a href=https://kubernetes.io/docs/concepts/services-networking/service/>Kubernetes 服务</a> - Kubernetes 服务集合了一系列的 Pod，并为集群中面向其他服务的 Pod 提供网络连接，无需公开每个 Pod 的真实私有 IP 地址。</li><li><a href=https://kubernetes.io/docs/concepts/storage/persistent-volumes/>Kubernetes 持久卷 (PV)</a> - 持久卷是用户<em>请求获得</em>持久存储（比如 NFS 文件存储）的一种方式。</li></ul><h3 id=hlem-相关概念>Hlem 相关概念</h3><h2 id=saas-设计>SaaS 设计</h2><h2 id=saas-实现>SaaS 实现</h2><h3 id=环境准备>环境准备</h3><blockquote><p>云原生(Cloud Native)相关技术版本迭代很快，API会随着版本的演进快速变化，本文章没有对环境进行广泛测试，若您没有相关经验，请务必选择相同的软件版本进行实验。</p></blockquote><ul><li><p>本地搭建：</p><ul><li><a href=https://www.docker.com/>docker</a> v18.03 或更新。</li><li><a href>kubernetes</a> v1.16 或更新。</li><li><a href>Helm</a> v3 或更新。</li></ul></li><li><p>云环境：</p></li></ul><h2 id=未来工作>未来工作</h2><p>限于字数，本文主要围绕对生产级 BaaS 服务的云原生改造进行了阐述，相比于 HyperLedger Fabric 的测试环境，本文所定义的生产级 HyperLedger Fabric
环境的可用性和安全性得到了提高，能够实现按需扩容并且服务非常容易迁徙，这些特性主要还是要感谢云原生技术的快速发展。</p><p>目前市场上大部分云服务提供商都开放了 BaaS 服务，相比于本文的设计方案，可以提供更多实用的功能。具体来说，主要包括：</p><ul><li><p>多租户隔离：</p></li><li><p>遥测监控：</p></li><li><p>日志收集：</p></li><li><p>不停机升级：</p></li><li><p>跨链：</p></li></ul><h2 id=参考资料>参考资料</h2><ul><li><p>[1] <a href=https://github.com/hyperledger-labs/minifabric>minifabric</a></p></li><li><p>[2] <a href=https://github.com/IBM/blockchain-network-on-kubernetes>在IBM Cloud上部署Hyperledger Fabric网络</a></p></li></ul><h4><a href=https://www.taibiaoguo.com></a></h4></div></div><footer class=container><hr class=soften><p><style type=text/css>#data{}</style><script type=text/javascript>var xmlhttp=new XMLHttpRequest,url="https://api.coindesk.com/v1/bpi/currentprice.json";xmlhttp.onreadystatechange=function(){if(this.readyState==4&&this.status==200){var a=JSON.parse(this.responseText);parseJson(a)}},xmlhttp.open("GET",url,!0),xmlhttp.send();function parseJson(a){var b=parseInt(a.bpi.USD.rate_float)+"美元";document.getElementById("data").innerHTML=b}</script><a href=https://www.blockchain.com/btc/address/1A1zP1eP5QGefi2DMPTfTL5SLmv7DivfNa>1A1zP1eP5QGefi2DMPTfTL5SLmv7DivfNa</a> |
&copy;
<a href=/about target=_blank>TaibiaoGuo</a>
<span id=thisyear>1995-2021</span>
| 比特币价格：
<span id=data></span></p><p class=text-center><a href=https://www.linkedin.com/in/taibiaoguo>Linkedin</a>
<a href=https://github.com/TaibiaoGuo>GitHub</a></p></footer></body><link rel=stylesheet href=/css/bootstrap.css><link rel=stylesheet href=/css/bootstrap-responsive.css><link rel=stylesheet href=/css/style.css><script src=/js/jquery.js></script><script src=/js/bootstrap-386.js></script><script src=/js/bootstrap-transition.js></script><script src=/js/bootstrap-alert.js></script><script src=/js/bootstrap-modal.js></script><script src=/js/bootstrap-dropdown.js></script><script src=/js/bootstrap-scrollspy.js></script><script src=/js/bootstrap-tab.js></script><script src=/js/bootstrap-tooltip.js></script><script src=/js/bootstrap-popover.js></script><script src=/js/bootstrap-button.js></script><script src=/js/bootstrap-collapse.js></script><script src=/js/bootstrap-carousel.js></script><script src=/js/bootstrap-typeahead.js></script><script src=/js/bootstrap-affix.js></script><script>_386={fastLoad:!1,onePass:!1,speedFactor:2};function ThisYear(){document.getElementById('thisyear').innerHTML=(new Date).getFullYear()}</script></html>